<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="ploneboard">
      
<body>

    <metal:css fill-slot="css_slot">

    <style type="text/css" media="all"
           tal:content="string: @import url($portal_url/ploneboard.css);"></style>
    </metal:css>

    <div metal:fill-slot="main">

        <metal:header use-macro="here/board_header/macros/header">Board header</metal:header>

        <h2 tal:content="here/Title">Conversation title</h2>

        <div class="documentdescription"
             tal:content="here/Description"> 
        description
        </div>

        <div class="boardComment visualIEFloatFix"
             tal:define="comment python:context">
             
            <metal:comment metal:define-macro="comment"
                           tal:define="creator comment/Creator;
                                       canView  python:checkPermission('Ploneboard: View Comment', comment);
                         	       revstate python:wtool.getInfoFor(comment, 'review_state');
                                       creation_date comment/creation_date;
                                       pss modules/Products/PythonScripts/standard">

                    <div class="boardCommentDetails" id=""
                         tal:attributes="id comment/getId">
                         <h3 tal:content="comment/Title">Post title</h3>
	  		 <span style="float: right" tal:condition="python: revstate == 'initial'">This post need to be review by administrators.</span>
                    <img src="" 
                         tal:attributes="src string:${portal_url}/ploneboard_comment_icon.gif"/>
                         <span i18n:translate="posted_by" tal:omit-tag="">Posted by</span>
                         <span tal:replace="creator">author</span> 
                         <span i18n:translate="text_at" tal:omit-tag="">at</span>
                         <span tal:replace="python:here.toPloneboardTime(creation_date)"
                               >Thursday 13:21</span>
                    </div>
                
                    <div class="boardCommentBody">
                
                        <div class="portrait">
                          <tal:block define="portrait python: here.portal_membership.getPersonalPortrait(creator);"> 
                                <img class="portraitPhoto"
                                     src="defaultUser.gif" 
                                     alt="" 
                                     border="0" 
                                     width="75" 
                                     height="100" 
                                     tal:attributes="src portrait/absolute_url" />
                                <div tal:content="comment/Creator">member id</div>
                          </tal:block>
                        </div>
                        
                        <div class="boardCommentContent">
 			     <span tal:replace="structure comment/getText"
                                  tal:condition="canView">Comment text.</span>
                             <span tal:condition="not: canView" i18n:translate="moderated_comment" style="color: #951001; font-weight: bold;"><br /><br /><br /><br />This comment has been widthdrawn.</span>
                        </div>
                        
                    </div>


                    <div class="visualClear"></div>

                    <div class="boardCommentActions" tal:define="canComment python:checkPermission('Ploneboard: Add Comment', comment) and checkPermission('Add portal content', comment);
                                     							 canReview  python:checkPermission('Ploneboard: Approve Comment', comment)" >
	
		    <div tal:define="creatorz python: mtool.searchForMembers({'name':creator});"
			 tal:repeat="creat creatorz"
			 class="boardCommentSignature">
			<p tal:replace="python: creat.getProperty('description', None)" />
		    </div>

                        <form class="group" onsubmit="return false;"
                              tal:condition="canReview">
                          <div>
                            <tal:transition repeat="transition python:wtool.getTransitionsFor(comment, here)">
                                <input class="standalone"
                                       type="submit"
                                       value="Retract"
                                       name="#"
                                       tabindex=""
                                       onclick="#"
                                       i18n:attributes="value"
                                       tal:define="hId here/getId"
                                       tal:attributes="onclick python:here.genCommentModerateOnClick(comment, transition);
                                                       value transition/name;
                                                       tabindex tabindex/next;" />
                            </tal:transition>
                          </div>
                        </form>

                        <form tal:condition="python: checkPermission('Ploneboard: Edit Comment', here)"
                              tal:attributes="action string:${comment/absolute_url}/base_edit">

                            <input class="standalone" 
                                   type="submit"
                                   value="Edit"
                                   i18n:attributes="edit"
                                   />
                        </form>

                        <form tal:condition="python: checkPermission('Ploneboard: Edit Comment', here)"
                              tal:attributes="action string:${comment/absolute_url}/object_delete">

                            <input class="standalone" 
                                   type="submit"
                                   value="Delete"
                                   i18n:attributes="delete"
                                   />
                        </form>

                        <fieldset tal:define="attachments comment/getAttachments"
                                  tal:condition="attachments"
                                  style="text-align: left;">
                            <legend i18n:translate="legend_attachments">Attachments</legend>
                            <ul class="visualNoMarker">
                                <li tal:repeat="attachment attachments">
                                    <a tal:attributes="href attachment/absolute_url">
                                        <span tal:define="pt attachment/portal_type"
                                              tal:attributes="class python:'contenttype-'+normalizeString(pt)">
                                            <span class="visualIconPadding"
                                                  tal:content="attachment/getId">
                                            Attachment title
                                            </span>
                                        </span>
                                    </a>
                                </li>
                            </ul>
                        </fieldset>

                    </div>

            </metal:comment>
        </div>
    </div>

</body>
</html>

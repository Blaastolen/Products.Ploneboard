<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="ploneboard">
      
<head>
    <metal:css fill-slot="css_slot">
    <style type="text/css" media="all"
           tal:content="string: @import url($portal_url/ploneboard.css);"></style>
    </metal:css>
</head>

<body>

    <div metal:fill-slot="main"
         tal:define="conversations here/getConversations;
                     pss modules/Products/PythonScripts/standard;">

        <metal:header use-macro="here/board_header/macros/header">Board header</metal:header>

        <h2>
        <img src="" tal:replace="structure here/ploneboard_forum_icon.gif" />
        <span tal:replace="here/Title">Forum title</span>
        </h2>

        <div class="documentDescription"
             tal:content="here/Description"> 
        Forum Description
        </div>
        
        <p class="discreet"
             tal:condition="not: conversations">
        No conversations in this forum yet.     
        </p>

        <form tal:attributes="action string:${here/absolute_url}/add_conversation_form"
              tal:condition="not: isAnon">
           <input class="standalone"
                  type="submit" 
                  value="Start a new Conversation" />
        </form>

        <form tal:condition="isAnon"
              tal:attributes="action python:'%s/login_form?came_from=%s' %
                                            (here.portal_url(),
                                            pss.url_quote(request['URL']))">

            <input class="standalone" 
                   type="submit" 
                   value="Log in to start a Conversation"
                   i18n:attributes="value"
                   />
        </form>

        <table class="listing"
               tal:condition="conversations">

            <thead>
                <tr>
                    <th>Conversation</th>
                    <th>Replies</th>
                    <th>Most Recent Comment</th>
                </tr>
            </thead>
        
            <tbody>
                <tal:showconversations tal:repeat="conversation conversations">
                
                <tr tal:define="oddrow repeat/conversation/odd;"
                    tal:attributes="class python:test(oddrow, 'even', 'odd')">
                    <td>
                        <a href=""
                           class="listingConversation"
                           tal:attributes="href conversation/absolute_url">
                            <span tal:replace="conversation/Title">This is a title</span>

                            <span class="discreet">
                                by <span tal:replace="conversation/Creator">This is a title</span>
                            </span>
                        </a>
                    </td>
                    
                    <td class="listingCheckbox"
                        tal:condition="conversation/getNumberOfReplies"
                        tal:content="conversation/getNumberOfReplies">
                    12 comments
                    </td>
    
                    <td class="listingCheckbox"
                        tal:condition="not: conversation/getNumberOfReplies">
                        <span class="discreet">None</span>
                    </td>

                    <!-- This should show "Thursday 13:56" if in this week, "Aug 13. 2003" if older than this week. (limi) -->
                    <td>
                        <span>
                            by <span tal:replace="conversation/getLastCommentAuthor">lastauthor</span>
                        </span>

                        <span class="discreet"
                             tal:content="python:here.toPloneboardTime(conversation.getLastCommentDate())">
                            Thursday 13:21
                        </span>
                    </td>
    
                </tr>
                
                </tal:showconversations>
            </tbody>
        </table>

        <div class="documentByLine">
        Powered by <a class="link-plain" href="http://plone.org/products/ploneboard">Ploneboard</a>
        </div>

    </div>
                     
</body>
</html>
